# 通过微信消息添加定时任务功能

## 功能说明

现在你可以直接通过微信私聊消息来添加定时任务，无需打开 exe 界面进行设置。

## 配置方法

### 方式一：通过 GUI 界面配置（推荐）⭐

1. 启动 RuoYuBot 程序
2. 在主界面的"主控制"标签页中找到"任务管理员"输入框
3. 输入允许添加任务的微信用户名称（每行一个）
4. 点击"更新"按钮保存
5. 配置立即生效，无需重启程序

**示例：**
```
张三
李四
王五
```

### 方式二：手动编辑配置文件

1. 打开 `config.ini` 文件
2. 找到 `task_admin_list` 配置项
3. 添加允许管理任务的微信好友名称（多个用逗号分隔）
4. 保存文件并重启程序

示例：
```ini
task_admin_list = 张三,李四,王五
```

## 支持的任务格式

### 1. 单次任务

在指定的日期和时间执行一次任务。

**格式：** `单次任务 日期 时间 [@接收者] 消息内容`

**示例：**
- `单次任务 2026-02-10 15:30 提醒开会` - 发给自己
- `单次任务 明天 14:00 @张三 记得吃药` - 发给张三
- `单次任务 后天 09:00 @张三,李四 准备材料` - 发给张三和李四
- `单次任务 02-15 10:00 @王五 生日提醒` - 发给王五

**支持的日期格式：**
- 自然语言：`今天`、`明天`、`后天`
- 标准格式：`2026-02-10`、`2026/02/10`、`2026.02.10`
- 简短格式：`02-10`、`02/10`（自动补充年份）

**支持的时间格式：**
- `15:30`
- `15时30分`
- `15点30分`

### 2. 每日任务

每天在指定时间执行任务。

**格式：** `每日任务 时间 消息内容`

**示例：**
- `每日任务 09:00 早安问候`
- `每日任务 18:00 下班提醒`
- `每天 12:00 午餐时间`

### 3. 每周任务

每周在指定星期和时间执行任务。

**格式：** `每周任务 星期 时间 消息内容`

**示例：**
- `每周任务 周一 09:00 周会提醒`
- `每周任务 星期三 14:00 部门会议`
- `每周 周五 17:00 周报提醒`

**支持的星期格式：**
- `周一`、`周二`、`周三`、`周四`、`周五`、`周六`、`周日`
- `星期一`、`星期二`、`星期三`、`星期四`、`星期五`、`星期六`、`星期日`
- `礼拜一`、`礼拜二`、`礼拜三`、`礼拜四`、`礼拜五`、`礼拜六`、`礼拜日`

### 4. 工作日任务

周一到周五每天在指定时间执行任务（自动创建5个任务）。

**格式：** `工作日 时间 消息内容`

**示例：**
- `工作日 09:00 打卡提醒`
- `工作日 18:00 下班打卡`

## 使用流程

1. 确保你的微信名称在 `task_admin_list` 中
2. 向机器人发送私聊消息，使用上述格式
3. 机器人会自动识别并添加任务
4. 收到成功确认消息后，任务即已生效

## 回复消息示例

### 成功添加任务
```
✅ 已成功添加单次任务
📅 日期: 2026-02-10
⏰ 时间: 15:30
📝 内容: 提醒开会
```

### 格式错误
```
❌ 无法识别时间格式: 25:00

📖 支持的格式:
• 单次任务 日期 时间 内容
  例: 单次任务 明天 15:30 提醒开会
• 每日任务 时间 内容
  例: 每日任务 09:00 早安问候
• 每周任务 星期 时间 内容
  例: 每周任务 周一 09:00 周会提醒
• 工作日 时间 内容
  例: 工作日 09:00 打卡提醒
```

## 注意事项

1. **权限控制**：只有在 `task_admin_list` 中配置的用户才能添加任务
2. **任务接收者**：通过消息添加的任务，接收者默认为发送命令的用户本人
3. **时间验证**：单次任务不能设置过去的时间
4. **自动生效**：任务添加后立即生效，无需重启程序
5. **任务管理**：可以在 exe 界面的"定时任务"标签页中查看、编辑或删除通过消息添加的任务

## 英文命令支持

为了方便，也支持英文命令：
- `once 2026-02-10 15:30 Reminder`
- `daily 09:00 Good morning`
- `weekly 周一 09:00 Meeting`
- `weekday 09:00 Clock in`

## 常见问题

**Q: 为什么我发送命令后没有反应？**
A: 请检查你的微信名称是否在 `config.ini` 的 `task_admin_list` 中。

**Q: 可以为其他人添加任务吗？**
A: 目前通过消息添加的任务只能发送给自己。如需为其他人添加任务，请使用 exe 界面。

**Q: 如何删除通过消息添加的任务？**
A: 打开 exe 界面，在"定时任务"标签页中找到对应任务，点击删除按钮。

**Q: 工作日任务会创建几个任务？**
A: 工作日任务会自动创建5个任务（周一到周五），每个任务独立管理。
