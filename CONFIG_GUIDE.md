# 配置示例文件

## config.ini 完整配置示例

```ini
[DEFAULT]
# 监听的群聊或好友名称列表（用逗号分隔）
listen_list = 技术交流群,产品讨论组,张三,李四

# Webhook回调地址（每行一个）
webhook_urls = http://192.168.1.100:8080/webhook
http://example.com/api/message

# 本地webhook服务器端口
port = 5000

# 消息发送重试次数
retry_count = 3

# 重试延迟时间（秒）
retry_delay = 5

# 日志级别（DEBUG, INFO, WARNING, ERROR）
log_level = INFO

# API认证令牌（用于webhook接口认证）
api_token = your_secret_token_here

# 允许通过消息添加任务的用户列表（用逗号分隔）
# 重要：只添加你信任的用户！
task_admin_list = 张三,李四,王五
```

## 配置说明

### listen_list（监听列表）
- 填写需要监听的群聊名称或好友名称
- 多个名称用英文逗号分隔
- 名称必须与微信中显示的完全一致（区分大小写）
- 示例：`技术交流群,产品讨论组,张三,李四`

### webhook_urls（Webhook地址）
- 填写接收消息的外部服务器地址
- 支持多个地址，每行一个
- 消息会同时发送到所有配置的地址
- 示例：
  ```
  http://192.168.1.100:8080/webhook
  http://example.com/api/message
  ```

### port（本地端口）
- 本地webhook服务器监听的端口
- 默认：5000
- 确保端口未被其他程序占用

### retry_count（重试次数）
- 消息发送失败时的重试次数
- 默认：3
- 建议范围：1-5

### retry_delay（重试延迟）
- 重试之间的延迟时间（秒）
- 默认：5
- 建议范围：3-10

### log_level（日志级别）
- 日志记录的详细程度
- 可选值：DEBUG, INFO, WARNING, ERROR
- 默认：INFO
- 调试时可设置为 DEBUG

### api_token（API令牌）
- 用于webhook接口的身份认证
- 建议使用复杂的随机字符串
- 保持此令牌的安全性，不要泄露

### task_admin_list（任务管理员列表）⭐新增
- 允许通过微信消息添加定时任务的用户列表
- 多个用户用英文逗号分隔
- 用户名称必须与微信中显示的完全一致
- **重要**：只添加你完全信任的用户！
- 示例：`张三,李四,王五`
- 留空则禁用消息添加任务功能

## 快速配置步骤

### 1. 基础配置（必需）

```ini
[DEFAULT]
listen_list = 你的好友名称
webhook_urls = http://your-server:port/webhook
port = 5000
api_token = your_secret_token
```

### 2. 启用消息添加任务功能（可选）

在基础配置的基础上添加：
```ini
task_admin_list = 你的微信名称
```

### 3. 高级配置（可选）

根据需要调整重试和日志设置：
```ini
retry_count = 3
retry_delay = 5
log_level = INFO
```

## 配置文件位置

配置文件 `config.ini` 应该与程序主文件在同一目录下：
- 如果使用 exe 版本：与 `RuoYuBot.exe` 在同一目录
- 如果使用源码版本：与 `main.py` 在同一目录

## 注意事项

1. **编码格式**：配置文件使用 UTF-8 编码，程序会自动检测和转换
2. **名称匹配**：所有名称必须与微信中显示的完全一致，包括大小写
3. **安全性**：
   - 妥善保管 `api_token`，不要泄露
   - 只将信任的用户添加到 `task_admin_list`
4. **修改生效**：修改配置后需要重启程序才能生效
5. **备份**：建议定期备份配置文件

## 常见配置错误

### 错误1：监听不到消息
**原因**：名称不匹配
**解决**：检查 `listen_list` 中的名称是否与微信中完全一致

### 错误2：Webhook发送失败
**原因**：地址错误或服务器未运行
**解决**：检查 `webhook_urls` 地址是否正确，确保目标服务器正在运行

### 错误3：端口被占用
**原因**：指定的端口已被其他程序使用
**解决**：修改 `port` 为其他未使用的端口（如 5001, 5002 等）

### 错误4：无法通过消息添加任务
**原因**：用户不在管理员列表中
**解决**：将用户名称添加到 `task_admin_list` 中

## 测试配置

配置完成后，可以通过以下方式测试：

1. **测试监听功能**：
   - 启动程序
   - 在监听列表中的群或好友发送消息
   - 查看程序日志是否收到消息

2. **测试Webhook功能**：
   - 发送消息后
   - 检查webhook服务器是否收到数据

3. **测试任务添加功能**：
   - 向机器人发送：`每日任务 09:00 测试消息`
   - 查看是否收到成功回复
   - 在程序界面的"定时任务"标签页中查看是否添加成功
